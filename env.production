# ===== MEESHY DIGITALOCEAN DEPLOYMENT CONFIGURATION =====
# Environment variables for DigitalOcean deployment with MongoDB
# Copy this file to .env for production deployment

# ===== DEPLOYMENT ENVIRONMENT =====
NODE_ENV="production"
DEBUG="false"
LOG_LEVEL="info"
DEPLOYMENT_ENV="digitalocean"
DEPLOYMENT_REGION="nyc3"

# ===== DOMAIN CONFIGURATION =====
# IMPORTANT: Mettez à jour avec votre vrai domaine !
DOMAIN="meeshy.me"
CERTBOT_EMAIL="admin@meeshy.me"

# ===== DATABASE CONFIGURATION =====
# Database type (MONGODB or POSTGRESQL)
DATABASE_TYPE="MONGODB"

# MongoDB connection (use MongoDB Atlas or self-hosted)
# Example for MongoDB Atlas:
# DATABASE_URL="mongodb+srv://username:password@cluster.mongodb.net/meeshy?retryWrites=true&w=majority"
# Example for self-hosted MongoDB with replica set:
DATABASE_URL="mongodb://meeshy-database:27017/meeshy?replicaSet=rs0"

# MongoDB specific settings
MONGODB_DATABASE="meeshy"
MONGODB_USER="meeshy"
MONGODB_PASSWORD="CHANGE_ME_MONGODB_PASSWORD"
MONGODB_PORT="27017"

# =============================================================================
# CONFIGURATION INITIALISATION BASE DE DONNÉES
# =============================================================================
# Forcer la réinitialisation complète de la base de données au démarrage
# ATTENTION: Ceci supprimera TOUTES les données existantes !
# Utiliser uniquement en développement ou pour réinitialiser complètement
FORCE_DB_RESET="false"

# =============================================================================
# CONFIGURATION UTILISATEURS PAR DÉFAUT
# =============================================================================
# Mot de passe pour l'utilisateur admin (utilisé aussi pour atabeth)
ADMIN_PASSWORD="CHANGE_ME_ADMIN_PASSWORD"

# Mot de passe pour l'utilisateur Meeshy (Bigboss)
MEESHY_BIGBOSS_PASSWORD="CHANGE_ME_MEESHY_PASSWORD"

# ===== REDIS CONFIGURATION =====
# Redis connection (no authentication in current setup)
REDIS_URL="redis://redis:6379"
REDIS_PASSWORD=""
REDIS_PORT="6379"

# Cache configuration
TRANSLATION_CACHE_TTL="3600"
CACHE_MAX_ENTRIES="50000"

# ===== JWT AUTHENTICATION =====
# IMPORTANT: Change these in production!
JWT_SECRET="CHANGE_ME_JWT_SECRET"
JWT_EXPIRES_IN="7d"

# ===== DEFAULT USERS CONFIGURATION =====
# IMPORTANT: Change these passwords in production!
MEESHY_BIGBOSS_PASSWORD="CHANGE_ME_MEESHY_PASSWORD"
ADMIN_PASSWORD="CHANGE_ME_ADMIN_PASSWORD"

# ===== SERVICE PORTS =====
# Gateway service
GATEWAY_PORT="3000"
PORT="3000"

# Translator service
TRANSLATOR_HTTP_PORT="8000"
TRANSLATOR_GRPC_PORT="50051"
FASTAPI_PORT="8000"
GRPC_PORT="50051"

# Frontend service
FRONTEND_PORT="3100"

# HTTP/HTTPS ports for Nginx
HTTP_PORT="80"
HTTPS_PORT="443"

# ===== ZMQ CONFIGURATION =====
# ZeroMQ ports for translation communication
ZMQ_PORT="5555"
ZMQ_TRANSLATOR_HOST="translator"
ZMQ_TRANSLATOR_PUSH_PORT="5555"
ZMQ_TRANSLATOR_SUB_PORT="5558"
ZMQ_TRANSLATOR_PULL_PORT="5555"
ZMQ_TRANSLATOR_PUB_PORT="5558"
ZMQ_TIMEOUT="10000"

# ===== TRANSLATION CONFIGURATION =====
# Supported languages (comma-separated)
SUPPORTED_LANGUAGES="fr,en,es,de,pt,zh,ja,ar"
DEFAULT_LANGUAGE="fr"

# Translation settings
AUTO_DETECT_LANGUAGE="true"
TRANSLATION_TIMEOUT="60"
MAX_TEXT_LENGTH="5000"
CONCURRENT_TRANSLATIONS="10"
TRANSLATION_WORKERS="20"

# ML model configuration for cloud deployment
BASIC_MODEL="Helsinki-NLP/opus-mt-en-fr"
MEDIUM_MODEL="facebook/nllb-200-distilled-600M"
PREMIUM_MODEL="facebook/nllb-200-distilled-600M"
DEVICE="cpu"
ML_BATCH_SIZE="8"
GPU_MEMORY_FRACTION="0.8"
QUANTIZATION_LEVEL="float16"

# Model management
MODELS_PATH="/workspace/models"
TORCH_HOME="/workspace/models"
HF_HOME="/workspace/models"
MODEL_CACHE_DIR="/workspace/models"
AUTO_CLEANUP_CORRUPTED_MODELS="true"
FORCE_MODEL_REDOWNLOAD="false"

# Model download configuration
MODEL_DOWNLOAD_MAX_RETRIES="5"
MODEL_DOWNLOAD_TIMEOUT="600"
MODEL_DOWNLOAD_CONSECUTIVE_TIMEOUTS="5"

# ===== WEBSOCKET CONFIGURATION =====
# WebSocket settings for cloud deployment
WS_MAX_CONNECTIONS="50000"
WS_PING_INTERVAL="30000"
WS_PING_TIMEOUT="10000"

# ===== CORS CONFIGURATION =====
# IMPORTANT: Update these URLs with your actual domain!
FRONTEND_URL="https://meeshy.me"
CORS_ORIGINS="https://meeshy.me,https://www.meeshy.me,https://gate.meeshy.me,https://ml.meeshy.me,https://traefik.meeshy.me,https://mongo.meeshy.me,https://redis.meeshy.me,http://157.230.15.51"
CORS_ORIGIN="${CORS_ORIGINS}"
ALLOWED_ORIGINS="https://meeshy.me,https://www.meeshy.me,https://gate.meeshy.me,https://ml.meeshy.me,https://traefik.meeshy.me,https://mongo.meeshy.me,https://redis.meeshy.me,http://157.230.15.51"

# ===== RATE LIMITING =====
# Rate limiting configuration for production
RATE_LIMIT_MAX="5000"
RATE_LIMIT_WINDOW="60000"

# ===== FRONTEND CONFIGURATION =====
# Next.js public environment variables (accessible from browser)
# IMPORTANT: Update these URLs with your actual domain!
NEXT_PUBLIC_API_URL="https://gate.meeshy.me"
NEXT_PUBLIC_WS_URL="wss://gate.meeshy.me"
NEXT_PUBLIC_BACKEND_URL="https://gate.meeshy.me"
NEXT_PUBLIC_TRANSLATION_URL="https://ml.meeshy.me"
TRANSLATOR_URL="http://translator:8000"
NEXT_PUBLIC_FRONTEND_URL="https://meeshy.me"

# Next.js configuration
NEXT_TELEMETRY_DISABLED="1"
NEXT_PUBLIC_DISABLE_CLIENT_TRANSLATION="true"
NEXT_PUBLIC_USE_API_TRANSLATION_ONLY="true"
NEXT_PUBLIC_DEBUG_LOGS="false"

# Authentifications (générez vos propres hash avec htpasswd -nB username)
TRAEFIK_USERS="admin:CHANGE_ME_TRAEFIK_HASH"
API_USERS="admin:CHANGE_ME_API_HASH"
MONGO_USERS="admin:CHANGE_ME_MONGO_HASH"
REDIS_USERS="admin:CHANGE_ME_REDIS_HASH"


# Internal URLs for SSR (container-to-container communication)
INTERNAL_BACKEND_URL="http://gateway:3000"
INTERNAL_WS_URL="ws://gateway:3000"

# ===== DOCKER CONFIGURATION =====
# Docker build arguments
DOCKER_BUILDKIT="1"
DOCKER_DEFAULT_PLATFORM="linux/amd64"

# Docker images (can be overridden for custom builds)
TRANSLATOR_IMAGE="isopen/meeshy-translator:latest"
GATEWAY_IMAGE="isopen/meeshy-gateway:latest"
FRONTEND_IMAGE="isopen/meeshy-frontend:latest"

# ===== PERFORMANCE OPTIMIZATION =====
# PyTorch optimization for cloud deployment
PYTORCH_CUDA_ALLOC_CONF="max_split_size_mb:256"
OMP_NUM_THREADS="8"
MKL_NUM_THREADS="8"
NUMEXPR_NUM_THREADS="8"

# Python optimization
PYTHONUNBUFFERED="1"

# ===== WORKER CONFIGURATION =====
# Worker pool settings optimized for cloud
WORKERS="8"
NORMAL_WORKERS="4"
ANY_WORKERS="2"

# Dynamic scaling configuration
NORMAL_WORKERS_DEFAULT="20"
ANY_WORKERS_DEFAULT="8"
NORMAL_WORKERS_MIN="4"
ANY_WORKERS_MIN="2"
NORMAL_WORKERS_MAX="100"
ANY_WORKERS_MAX="50"
NORMAL_WORKERS_SCALING_MAX="100"
ANY_WORKERS_SCALING_MAX="50"

# ===== MONITORING =====
# Health check settings
HEALTH_CHECK_INTERVAL="30"
HEALTH_CHECK_TIMEOUT="10"
HEALTH_CHECK_RETRIES="3"

# ===== SECURITY =====
# Security headers
HELMET_ENABLED="true"
CONTENT_SECURITY_POLICY="true"

# Advanced security
SECURITY_HEADERS_ENABLED="true"
CONTENT_SECURITY_POLICY_STRICT="true"
HSTS_ENABLED="true"
XSS_PROTECTION_ENABLED="true"

# ===== LOGGING =====
# Logging configuration for production
LOG_FORMAT="json"
LOG_FILE="/var/log/meeshy/meeshy.log"
LOG_MAX_SIZE="100m"
LOG_MAX_FILES="10"

# Advanced logging
LOG_LEVEL_DEBUG="false"
LOG_LEVEL_INFO="true"
LOG_LEVEL_WARN="true"
LOG_LEVEL_ERROR="true"

# ===== BACKUP & RECOVERY =====
# Backup settings
BACKUP_ENABLED="true"
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS="30"
BACKUP_COMPRESSION="true"
BACKUP_ENCRYPTION="true"

# ===== NETWORKING =====
# Network configuration for cloud deployment
ENABLE_HTTPS="true"
PROXY_ENABLED="true"

# ===== OPTIMIZATION =====
# Performance optimization for production
ENABLE_COMPRESSION="true"
ENABLE_MINIFICATION="true"
ENABLE_CDN_CACHE="true"
CACHE_INVALIDATION_ENABLED="true"

# ===== SCALING =====
# Auto-scaling configuration
AUTO_SCALE_ENABLED="true"
AUTO_SCALE_MIN_INSTANCES="2"
AUTO_SCALE_MAX_INSTANCES="20"
AUTO_SCALE_CPU_THRESHOLD="70"

# ===== CLOUD PROVIDER =====
# DigitalOcean specific settings
CLOUD_PROVIDER="digitalocean"
DIGITALOCEAN_REGION="nyc3"
DIGITALOCEAN_SIZE="s-4vcpu-8gb"

# ===== MONITORING & ALERTS =====
# Monitoring configuration
MONITORING_ENABLED="true"
METRICS_ENABLED="true"
METRICS_PORT="9090"
PROMETHEUS_ENABLED="true"

# Alert configuration
ALERTS_ENABLED="true"
ALERT_THRESHOLD_CPU="80"
ALERT_THRESHOLD_MEMORY="85"
ALERT_THRESHOLD_DISK="90"

# ===== SSL/TLS =====
# SSL certificate paths (for custom certificates)
SSL_CERT_PATH="/etc/nginx/ssl/cert.pem"
SSL_KEY_PATH="/etc/nginx/ssl/key.pem"

# ===== FEATURE FLAGS =====
# Feature flags for production
FEATURE_NEW_UI="true"
FEATURE_ADVANCED_TRANSLATION="true"
FEATURE_VIDEO_CHAT="false"
FEATURE_VOICE_MESSAGES="false"

# ===== COMPLIANCE =====
# Compliance settings
GDPR_COMPLIANCE="true"
DATA_RETENTION_DAYS="365"
ENABLE_AUDIT_LOGS="true"
ENABLE_DATA_ENCRYPTION="true"

# ===== INTEGRATION =====
# API configuration
ENABLE_API_RATE_LIMITING="true"
API_RATE_LIMIT="10000"

# ===== PERFORMANCE MONITORING =====
# Performance monitoring
PERFORMANCE_MONITORING_ENABLED="true"
PERFORMANCE_THRESHOLD_RESPONSE_TIME="2000"
PERFORMANCE_THRESHOLD_MEMORY_USAGE="80"
PERFORMANCE_THRESHOLD_CPU_USAGE="70"

# ===== RELIABILITY =====
# Reliability settings
CIRCUIT_BREAKER_ENABLED="true"
RETRY_MECHANISM_ENABLED="true"
FALLBACK_MECHANISM_ENABLED="true"

# ===== PRISMA CONFIGURATION =====
# Prisma schema path (should be empty for production as schema is built-in)
PRISMA_SCHEMA_PATH=""

# Prisma pool configuration for production
PRISMA_POOL_SIZE="50"
PRISMA_QUERY_ENGINE_LIBRARY=""
PRISMA_CLIENT_ENGINE_TYPE="library"
PRISMA_DISABLE_WARNINGS="true"

# ===== DEVELOPMENT =====
# Development settings (disabled in production)
ENABLE_DEBUG_MODE="false"
ENABLE_PROFILING="false"
ENABLE_DEBUG_TOOLS="false"

# ===== VERSION =====
# Deployment version
DEPLOYMENT_VERSION="1.0.0-production"

# ===== CONTACT =====
# Support configuration
SUPPORT_EMAIL="support@meeshy.me"
FEEDBACK_EMAIL="feedback@meeshy.me"

# ===== BRAND =====
# Custom branding
BRAND_NAME="Meeshy"
BRAND_COLOR="#3B82F6"

# ===== FINAL NOTES =====
# This configuration is optimized for DigitalOcean deployment
# Make sure to:
# 1. Update all domain references (meeshy.me) with your actual domain
# 2. Change all default passwords and secrets
# 3. Configure SSL certificates
# 4. Set up monitoring and alerts
# 5. Configure backup strategies
# 6. Test thoroughly before production deployment

# ===== SECRETS DE PRODUCTION ======
# Générés automatiquement le Mon Sep  8 21:03:56 CEST 2025
# ===== MEESHY PRODUCTION SECRETS =====
# Fichier généré automatiquement - NE PAS COMMITER
# Date de génération: Sun Sep  7 22:06:25 CEST 2025
# 
# ⚠️  ATTENTION: Ce fichier contient des informations sensibles
# ⚠️  Ne jamais le commiter dans Git ou le partager
# ⚠️  Conserver ce fichier dans un endroit sécurisé

# ===== JWT AUTHENTICATION =====
JWT_SECRET="JifEemKSYUdbJfSeoGun7egUAj9wbgfNb6EGPgtl6CyjYo070LZ3AAmKyvkjI8VM9fsdywDyoB9FWM56XY4FA"
JWT_EXPIRES_IN="7d"

# ===== MOTS DE PASSE UTILISATEURS =====
# Mots de passe pour les utilisateurs par défaut
ADMIN_PASSWORD="xYipoticeNIp0PwBYk7Z"
MEESHY_PASSWORD="mtMlICIB30hM1tW214tk"
ATABETH_PASSWORD="IUaAasGtFD8QrXixxdWz"

# ===== MOTS DE PASSE SERVICES =====
# Mots de passe pour les services
MONGODB_PASSWORD="3x1xfX0z9oOyQ8onWJ8vRybD"
REDIS_PASSWORD="Qm4175ndn8t6WAH4J69p"

# ===== EMAILS DE PRODUCTION =====
ADMIN_EMAIL="admin@meeshy.me"
MEESHY_EMAIL="meeshy@meeshy.me"
ATABETH_EMAIL="atabeth@meeshy.me"
SUPPORT_EMAIL="support@meeshy.me"
FEEDBACK_EMAIL="feedback@meeshy.me"

# ===== DOMAINE DE PRODUCTION =====
DOMAIN="meeshy.me"

# ===== HASHES D'AUTHENTIFICATION =====
# Hashes bcrypt pour les authentifications (générés avec htpasswd)
TRAEFIK_USERS="admin:\$2y\$05\$57BhDUlXTrcEebSStNqQ3.645jJOMP0PRjpXF23opyIv1euCPEN1W"
API_USERS="admin:\$2y\$05\$FAZ6qJKKgidBFVCY.RzeXuAmvOekUtmk.bPJIuU/rknG5N4F7nwi."
MONGO_USERS="admin:\$2y\$05\$EkGYl6oTdxKa2pmOteEQL.EQ62b.T6uMHWWlfTg7KuX5WsjRy.YL."
REDIS_USERS="admin:\$2y\$05\$fzDuH6VLfghQBsoV09cl8.C/C5JXuBPsi76.knBfMHmMAQtzFfnx6"

# ===== CONFIGURATION UTILISATEURS DÉTAILLÉE =====
# Configuration utilisateur Meeshy (BIGBOSS)
MEESHY_USERNAME="meeshy"
MEESHY_FIRST_NAME="Meeshy"
MEESHY_LAST_NAME="Sama"
MEESHY_ROLE="BIGBOSS"
MEESHY_SYSTEM_LANGUAGE="en"
MEESHY_REGIONAL_LANGUAGE="fr"
MEESHY_CUSTOM_DESTINATION_LANGUAGE="pt"

# Configuration utilisateur Admin
ADMIN_USERNAME="admin"
ADMIN_FIRST_NAME="Admin"
ADMIN_LAST_NAME="Manager"
ADMIN_ROLE="ADMIN"
ADMIN_SYSTEM_LANGUAGE="es"
ADMIN_REGIONAL_LANGUAGE="de"
ADMIN_CUSTOM_DESTINATION_LANGUAGE="zh"

# Configuration utilisateur André Tabeth (entièrement configurable)
ATABETH_USERNAME="atabeth"
ATABETH_FIRST_NAME="André"
ATABETH_LAST_NAME="Tabeth"
ATABETH_ROLE="USER"
ATABETH_SYSTEM_LANGUAGE="fr"
ATABETH_REGIONAL_LANGUAGE="fr"
ATABETH_CUSTOM_DESTINATION_LANGUAGE="en"

# ===== CONFIGURATION BASE DE DONNÉES =====
# Forcer la réinitialisation pour la production
FORCE_DB_RESET="true"

# ===== INFORMATIONS DE DÉPLOIEMENT =====
# Informations pour le déploiement
DEPLOYMENT_DATE="Sun Sep  7 22:06:25 CEST 2025"
DEPLOYMENT_VERSION="1.0.0-production"
DEPLOYMENT_ENV="production"
